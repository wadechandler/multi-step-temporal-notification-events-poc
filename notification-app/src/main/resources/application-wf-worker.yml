---
# Conditional autoconfigure exclusions — only applied when service profile is NOT active.
# When running combined (local dev with service,ev-worker,wf-worker), the service profile
# handles DataSource/JPA/Flyway, so these exclusions must be skipped.
spring:
  config:
    activate:
      on-profile: "!service"
  autoconfigure:
    exclude:
      - org.springframework.boot.jdbc.autoconfigure.DataSourceAutoConfiguration
      - org.springframework.boot.hibernate.autoconfigure.HibernateJpaAutoConfiguration
      - org.springframework.boot.flyway.autoconfigure.FlywayAutoConfiguration
      - org.springframework.boot.data.jpa.autoconfigure.JpaRepositoriesAutoConfiguration

---
# Profile: wf-worker (combined mode)
# Temporal worker (workflows + activities), RestClient (activities call REST APIs).
# No Kafka consumer. Web server runs only for actuator health/metrics.

spring:
  kafka:
    listener:
      auto-startup: false

temporal:
  connection:
    target: ${TEMPORAL_ADDRESS:localhost:7233}
  worker:
    task-queue: ${TEMPORAL_TASK_QUEUE:NOTIFICATION_QUEUE}

# Services (base URL for activity HTTP calls — in K8s, targets the service deployment)
services:
  base-url: ${SERVICES_BASE_URL:http://notification-service:8080}
